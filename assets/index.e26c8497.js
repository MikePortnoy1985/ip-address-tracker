var I=Object.defineProperty,M=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var P=(r,e,t)=>e in r?I(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,h=(r,e)=>{for(var t in e||(e={}))D.call(e,t)&&P(r,t,e[t]);if(S)for(var t of S(e))U.call(e,t)&&P(r,t,e[t]);return r},f=(r,e)=>M(r,C(e));import{P as l,r as y,j as u,a as s,c as w,L as _,M as x,T as $,b as k,d as q,u as j,R as F}from"./vendor.49fdcf72.js";const G=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}};G();const o={IDLE:"idle",LOADING:"loading",SUCCESS:"success",ERROR:"error"},R=[51.505,-.09],z=15,E=7,H=/((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(.|$)){4}/;const K="Search for any API or domain";function N({disabled:r,handleUserPosition:e}){const[t,a]=y.exports.useState(""),[n,i]=y.exports.useState(!0),d=r||!n||!!t&&t.length<E,c=p=>{a(p.target.value),i(H.test(p.target.value))};return u("form",{className:"input",onSubmit:p=>{p.preventDefault(),e(t)},children:[s("input",{className:w("input-field",{"input-field_invalid":!n}),placeholder:K,type:"text",value:t,onChange:c,minLength:E,maxLength:z}),s("button",{className:"input-button",type:"submit","aria-label":"submit",disabled:d,children:s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"11",height:"14",children:s("path",{fill:"none",stroke:"#FFF",strokeWidth:"3",d:"M2 1l6 6-6 6"})})})]})}N.propTypes={disabled:l.bool.isRequired,handleUserPosition:l.func.isRequired};function L({disabled:r,handleUserPosition:e}){return u("div",{className:"header",children:[s("div",{className:"title",children:"IP Address Tracker"}),s(N,{disabled:r,handleUserPosition:e})]})}L.propTypes={disabled:l.bool.isRequired,handleUserPosition:l.func.isRequired};var V="https://mikeportnoy1985.github.io/ip-address-tracker/assets/icon-location.a6da85d9.svg";function B({coords:r}){const e=j();return e.setView(r,e.getZoom()),null}const W=new _.Icon({iconUrl:V,popupAnchor:[0,0],iconSize:[46,56]});function b({position:r}){return u(x,{className:"map",zoom:13,center:r,zoomControl:!1,scrollWheelZoom:!0,children:[s($,{attribution:'\xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s(k,{position:r,icon:W,children:s(q,{children:"Current location"})}),s(B,{coords:r})]})}b.propTypes={position:l.arrayOf(l.number).isRequired};function O({children:r}){return s("div",{className:"panel",children:r})}O.propTypes={children:l.oneOfType([l.arrayOf(l.node),l.node]).isRequired};function A({title:r,info:e}){return u("div",{className:"panel-card",children:[s("div",{className:"panel-card__title",children:r}),s("div",{className:"panel-card__info",children:e})]})}A.propTypes={title:l.string.isRequired,info:l.string.isRequired};function X(){return u("div",{className:"panel-card",children:[s("div",{className:"panel-card__title"}),s("div",{className:"panel-card__info"})]})}function v({message:r}){return s("div",{className:"error",children:r})}v.propTypes={message:l.string};v.defaultProps={message:""};const Z="at_y1mPjv32JLLno3X990RrtdzqSpbvo",J=`https://geo.ipify.org/api/v2/country,city?apiKey=${Z}`;class Y{constructor(e,t){this.url=e,this.position=t,this.emptyField=" "}async getDefaultPosition(){const e=await fetch(this.url);if(!e.ok){const t={message:`Error: ${e.statusText}`};return Promise.reject(t)}return Promise.resolve(e.json())}async getUserPosition(e){const t=await fetch(`${this.url}&ipAddress=${e}`);if(!t.ok){const a={message:`Error: ${t.statusText}`};return Promise.reject(a)}return Promise.resolve(t.json())}convertResponse(e){return this.response={panel:[{id:Math.random(),title:"ip address",info:this.convertField(e.ip)},{id:Math.random(),title:"location",info:this.convertField(e.location.city,e.location.region,e.location.country)},{id:Math.random(),title:"timezone",info:this.convertField(e.location.timezone)},{id:Math.random(),title:"isp",info:this.convertField(e.isp)}],position:this.setPosition(e.location.lat,e.location.lng)},this.response}convertField(e,t,a){return e&&t&&a?`${e}, ${t}, ${a}`:!!e||!!t||a?e||t||a:this.emptyField}setPosition(e,t){return!e||!t?this.position:[e,t]}}var g=new Y(J,R);const T={getDefaultPosition(r){r({type:o.LOADING}),g.getDefaultPosition().then(e=>{r({type:o.SUCCESS,payload:g.convertResponse(e)})},e=>{r({type:o.ERROR,payload:e})})},getUserPosition(r,e){e({type:o.LOADING}),g.getUserPosition(r).then(t=>{e({type:o.SUCCESS,payload:g.convertResponse(t)})},t=>{e({type:o.ERROR,payload:t})})}};const Q={status:o.IDLE,data:{panel:[Math.random(),Math.random(),Math.random(),Math.random()],position:R},error:null},ee=(r,e)=>{switch(e.type){case o.LOADING:return f(h({},r),{status:o.LOADING});case o.SUCCESS:return f(h({},r),{data:e.payload,status:o.SUCCESS});case o.ERROR:return f(h({},r),{error:e.payload,status:o.ERROR});default:return r}};function te(){const[r,e]=y.exports.useReducer(ee,Q),{status:t,error:a,data:n}=r,i=[o.IDLE,o.LOADING].includes(t),d=c=>{T.getUserPosition(c,e)};return y.exports.useEffect(()=>{t===o.IDLE&&T.getDefaultPosition(e)},[t]),u("div",{className:"app",children:[s(L,{disabled:i,handleUserPosition:d}),u(O,{children:[i&&n.panel.map(c=>{var m;return s(X,{},(m=c.id)!=null?m:c)}),t===o.SUCCESS&&n.panel.map(({id:c,title:m,info:p})=>s(A,{title:m,info:p},c)),s(v,{message:a==null?void 0:a.message})]}),s(b,{position:n.position})]})}F.render(s(te,{}),document.getElementById("root"));
